(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{355:function(s,a,e){"use strict";e.r(a);var l=e(7),t=Object(l.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h4",{attrs:{id:"查询是否开启-mysql-慢查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询是否开启-mysql-慢查询"}},[s._v("#")]),s._v(" 查询是否开启 mysql 慢查询")]),s._v(" "),a("ol",[a("li",[s._v("首先进入到 mysql 命令行模式")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql -u 用户名 -p \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("查看是否开启慢查询功能")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" show variables like 'slow_query%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("+---------------------+-----------------------------------+\n| Variable_name       | Value                             |\n+---------------------+-----------------------------------+\n| slow_query_log      | OFF                                |\n| slow_query_log_file | /var/lib/mysql/homestead-slow.log |\n+---------------------+-----------------------------------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ul",[a("li",[s._v("slow_query_log = off  表示没有开启慢查询")]),s._v(" "),a("li",[s._v("slow_query_log_file    表示慢查询日志存放的目录")])]),s._v(" "),a("h4",{attrs:{id:"开启慢查询和相关设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开启慢查询和相关设置"}},[s._v("#")]),s._v(" 开启慢查询和相关设置")]),s._v(" "),a("ol",[a("li",[s._v("开启慢查询(及时性重启mysql后失效)")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("set global slow_query_log=ON;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("设置慢查询日志存放的位置")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("set global slow_query_log_file='/var/lib/mysql/slow.log';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"设置慢查询时间-超过此值的sql将会记录下来"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置慢查询时间-超过此值的sql将会记录下来"}},[s._v("#")]),s._v(" 设置慢查询时间(超过此值的sql将会记录下来)")]),s._v(" "),a("ol",[a("li",[s._v("查询当前的设置的时间(mysql默认10秒)")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("show variables like 'long_query%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("+-----------------+-----------+\n| Variable_name   | Value     |\n+-----------------+-----------+\n| long_query_time | 10.000000 |\n+-----------------+-----------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("设置慢查询时间")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("set long_query_time=0.5;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("通常来说一条sql执行时间不应该超过500毫秒, 这个时间已经很慢了")]),s._v(" "),a("li",[s._v("sql执行50毫秒左右最佳")]),s._v(" "),a("li",[s._v("这里要提一下程序执行的时间不止是sql 还需要php代码执行等因素,所以一般来说 get请求100毫秒左右, post请求 200毫秒以内 超过这个时间就需要具体优化了.")])])])}),[],!1,null,null,null);a.default=t.exports}}]);