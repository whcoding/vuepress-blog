(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{344:function(s,t,e){"use strict";e.r(t);var a=e(7),n=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h6",{attrs:{id:"letsencrypt-为1-8亿个网站提供tls证书的非盈利性证书颁发机构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#letsencrypt-为1-8亿个网站提供tls证书的非盈利性证书颁发机构"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"https://letsencrypt.org/zh-cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("letsencrypt"),t("OutboundLink")],1),s._v("  为1.8亿个网站提供TLS证书的非盈利性证书颁发机构")]),s._v(" "),t("h5",{attrs:{id:"安装-letsencrypt"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-letsencrypt"}},[s._v("#")]),s._v(" 安装 letsencrypt")]),s._v(" "),t("div",{staticClass:"language-code line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("apt install letsencrypt\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h5",{attrs:{id:"生成-ssl-所需证书文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成-ssl-所需证书文件"}},[s._v("#")]),s._v(" 生成 ssl 所需证书文件")]),s._v(" "),t("p",[s._v("注意: 生成的时候要先停止 nginx")]),s._v(" "),t("div",{staticClass:"language-code line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("letsencrypt certonly --standalone --email your@mail.com -d text1.com -d text2.com\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h5",{attrs:{id:"成功生成如下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#成功生成如下"}},[s._v("#")]),s._v(" 成功生成如下:")]),s._v(" "),t("div",{staticClass:"language-code line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("IMPORTANT NOTES:\n- Congratulations! Your certificate and chain have been saved at\n/etc/letsencrypt/live/xxx/fullchain.pem. Your cert\nwill expire on 2020-05-19. To obtain a new version of the\ncertificate in the future, simply run Let's Encrypt again.\n- If you like Let's Encrypt, please consider supporting our work by:\nDonating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate\nDonating to EFF:                    https://eff.org/donate-le\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h5",{attrs:{id:"证书有效期只有-90-天-免费续期的命令如下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#证书有效期只有-90-天-免费续期的命令如下"}},[s._v("#")]),s._v(" 证书有效期只有 90 天, 免费续期的命令如下")]),s._v(" "),t("div",{staticClass:"language-code line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("letsencrypt certonly --renew-by-default --email your@mail.com -d text1.com -d text2.com\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h5",{attrs:{id:"配置-crontab-定时任务-自动续期"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-crontab-定时任务-自动续期"}},[s._v("#")]),s._v(" 配置 crontab 定时任务, 自动续期")]),s._v(" "),t("h6",{attrs:{id:"编写自动续期脚本-updatehttps-sh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编写自动续期脚本-updatehttps-sh"}},[s._v("#")]),s._v(" 编写自动续期脚本, updateHttps.sh")]),s._v(" "),t("div",{staticClass:"language-code line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo service nginx stop\n\n/usr/bin/letsencrypt certonly --renew-by-default --email your@mail.com -d text1.com -d text2.com\n\nsudo service nginx start\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h6",{attrs:{id:"crontab-e"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#crontab-e"}},[s._v("#")]),s._v(" crontab -e")]),s._v(" "),t("div",{staticClass:"language-code line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("* * 1 * * /realpath/updateHttps.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h5",{attrs:{id:"修改-nginx-conf-添加-https"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改-nginx-conf-添加-https"}},[s._v("#")]),s._v(" 修改 nginx.conf, 添加 https")]),s._v(" "),t("div",{staticClass:"language-code line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("server {\n\t# 强制跳转https\n\tif ($scheme = http) {\n\t   return 301 https://$server_name$request_uri;\n\t}\n\n\tlisten 443 ssl;\n\tssl_certificate   /etc/letsencrypt/live/text1.comfullchain.pem;\n\tssl_certificate_key  /etc/letsencrypt/live/text1.comprivkey.pem;\n\tssl_session_timeout 5m;\n\tssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;\n\tssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n\tssl_prefer_server_ciphers on;\n\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);